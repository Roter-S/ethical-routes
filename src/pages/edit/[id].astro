---
import Layout from "@layouts/Layout.astro";
import AppLayout from "@layouts/AppLayout.astro";
import EditEthicalRoute from "@components/EditEthicalRoute";
import { firestore } from "@lib/firebase/server";
import type { EthicalRouteTypeWithId } from "@lib/types";

const id = Astro.params.id;
if (!id) throw new Error("ID faltante");

const routeDoc = await firestore.collection("ethical_routes").doc(id).get();

if (!routeDoc.exists) {
  return Astro.redirect("/404");
}

const routeData = {
  documentId: routeDoc.id,
  ...routeDoc.data(),
} as EthicalRouteTypeWithId;
---

<Layout title="Editar caso Ã©tico">
  <AppLayout>
    <EditEthicalRoute client:load id={id} initialData={routeData} />
  </AppLayout>
</Layout>
